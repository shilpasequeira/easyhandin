<!-- Container Begin -->
<div class="row">
  <div class="large-12 columns">
    <div class="box bg-white">
      <div class="box-header bg-transparent">
        <h3 class="box-title"><i class="fontello-paper-plane"></i>
          <span>SUBMISSIONS</span>
        </h3>
      </div>
      <!-- /.box-header -->
      <div class="box-body" style="display: block;">
        <span class="top-right">
          <%= link_to 'Run Test', "#", class: "button tiny", style: "margin-bottom: 0px" %>&nbsp; <!--test_path(submission)-->
          <%= link_to 'Run MOSS', "#", class: "button tiny" %>
        </span>
        <table id="footable-res2" class="fixed-ellipsis demo no-paging footable-loaded footable tablet breakpoint" data-filter="#filter" data-filter-text-only="true">
          <thead>
          <tr>
            <th>
              Student Name
            </th>
            <th>
              Student Number
            </th>
            <th>
              Github Username
            </th>
            <th>
              Test status
            </th>
            <th>
              Grade
            </th>
            <th>
              Feedback
            </th>
            <th class="menu_items"></th>
          </tr>
          </thead>
          <tbody>
          <% @assignment.submissions.each do |submission| %>
          <tr>
            <td>
              <%= User.find_by(id: submission.submitter_id).name %>
            </td>
            <td>
              <%= User.find_by(id: submission.submitter_id).id %> <!-- this needs to be replaced by UBC student id once added to the model-->
            </td>
            <td>
              <%= User.find_by(id: submission.submitter_id).username %>
            </td>
            <td class="ellipsis">
              <% if submission.test_result? %>
              <%= link_to submission.test_result, "data-reveal-id" => "testResult" do %>
              <i class="fontello-eye" title="view"></i>
              <% end %>
              <% end %>
              <% if !submission.test_result? %>
              <i class="fontello-eye">No result</i>
              <% end %>
            </td>
            <td><%= submission.grade %></td>
            <td class="ellipsis">
              <%= link_to submission.feedback, "data-reveal-id" => "feedback" do %>
              <i class="fontello-eye" title="view"></i>
              <% end %>
            </td>
            <td >
              <%= link_to submission do %>
              <i class="fontello-eye" title="view"></i>
              <% end %>
              <%= link_to edit_submission_path(submission), "data-reveal-id" => "editSubmission", method: :get, :remote => true do %>
              <i class="fontello-pencil" title="edit"></i>
              <% end %>
            </td>
          </tr>

          <!-- Reveal Modals testResult -->
          <div id="testResult" class="reveal-modal" data-reveal>
            <h4>Test Results</h4>
            <p><pre><%= submission.test_output %></pre></p>
            <%= link_to "&#215;".html_safe, "#", class: "close-reveal-modal" %>
          </div>

          <!-- Reveal Modals feedback -->
          <div id="feedback" class="reveal-modal" data-reveal>
            <h4>Feedback</h4>
            <p><pre><%= submission.feedback %></pre></p>
            <%= link_to edit_submission_path(submission) do %>
            <i class="fontello-pencil" title="edit"></i>
            <% end %>
            <%= link_to "&#215;".html_safe, "#", class: "close-reveal-modal" %>
          </div>

          <!-- Reveal Modals editSubmission -->
          <div id="editSubmission" class="reveal-modal" data-reveal>
            <%= render '/submissions/form', submission: submission %>
            <%= link_to "&#215;".html_safe, "#", class: "close-reveal-modal" %>
          </div>

          <% end %>
          </tbody>
        </table>
        <!-- end of submissions table -->
      </div>
      <!-- end of student box body -->
    </div>
    <!-- end of student box -->
  </div>
  <!-- end of student div -->
</div>
<!-- End of Container Begin -->